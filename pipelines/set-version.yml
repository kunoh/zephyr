steps:
- template: normalize.yml

- script: |
    echo "##vso[task.setvariable variable=version]pr-$(system.pullrequest.pullrequestid)"
  displayName: 'Set version for pull request build'
  condition: ne(variables['system.pullrequest.pullrequestid'], '')

- script: |
    echo "##vso[task.setvariable variable=patch]$(buildCounter)"
    echo "##vso[task.setvariable variable=versionSuffix]"
  displayName: 'Set version for release branch build'
  condition: startsWith(variables['Build.SourceBranch'], 'refs/heads/release/')

- script: |
    echo "##vso[build.updatebuildnumber]$(version)"
  displayName: 'Set build number'
